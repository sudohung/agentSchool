FAISS MCP (CPU Embedding) - README

- Purpose: lightweight FAISS-based MCP server that computes sentence-transformer embeddings on CPU (default) and exposes MCP tools to add/search/save a local knowledge store.

- Path: `mcp/acknowledgeFaiMcp`

- Quick start (recommended)
  - Create and activate a Python venv (optional but recommended):
    - `python -m venv .venv && .venv\Scripts\activate` (Windows)
    - `python -m venv .venv && source .venv/bin/activate` (Linux/macOS)
  - Install dependencies (CPU):
    - `pip install -r mcp/acknowledgeFaiMcp/requirements.txt` (if you use the provided requirements file)
    - Or install manually: `pip install faiss-cpu numpy sentence-transformers python-dotenv`
    - Note: on Windows `faiss-cpu` pip wheel may not be available; if pip install fails, use conda: `conda install -c conda-forge faiss-cpu numpy`

- Environment variables (optional)
  - `FAISS_EMBEDDER_MODEL` — embedding model name (default: `all-MiniLM-L6-v2`)
  - `FAISS_DIM` — embedding dimensionality (default: `384` for `all-MiniLM-L6-v2`)
  - `FAISS_INDEX_PATH` / `FAISS_META_PATH` — paths for index and metadata files (defaults: `faiss.index`, `faiss_meta.json`)

- Files created
  - `faiss_mcp_server.py` — MCP server implementation (tools: `faiss_add_items`, `faiss_search`, `faiss_save`).
  - `demo_mcp_client.py` — demo client that starts the server via stdio, adds documents, searches, and saves.

- Run server (HTTP SSE transport)
  - `python mcp/acknowledgeFaiMcp/faiss_mcp_server.py --transport streamable_http --port 8001`

- Run demo client (starts server using stdio transport)
  - `python mcp/acknowledgeFaiMcp/demo_mcp_client.py`

- Using the MCP tools (JSON payload examples)
  - Add documents (server computes embeddings):
    ```json
    {"ids":[101,102],"documents":["文本A","文本B"],"metadatas":[{"src":"a"},{"src":"b"}]}
    ```
  - Search by text:
    ```json
    {"query_text":"查找 A","k":5}
    ```
  - Search by embedding:
    ```json
    {"query_embedding":[0.12,0.34,...],"k":5}
    ```

- Notes & troubleshooting
  - First run will download sentence-transformers model weights (requires internet). Be patient — model download and CPU init can take tens of seconds.
  - Ensure `FAISS_DIM` matches the embedding model output dimension. Mismatch will raise an error.
  - If you see errors importing `faiss`, try installing via conda-forge as noted above.
  - FAISS removal/true-delete is not implemented for IndexFlat in this lightweight example; to remove items you should rebuild the index from desired items.

- Next steps
  1. Use `demo_mcp_client.py` to validate end-to-end flow.
  2. If you need Docker or a longevity production setup, ask and I'll add Docker/Compose files.

---
Generated by OpenCode — file: `mcp/acknowledgeFaiMcp/README.md`
